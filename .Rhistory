#########
# 2. Create the plot
#########
# Have total emissions from PM2.5 decreased in the United States from 1999 to 2008?
# Using the base plotting system, make a plot showing the total PM2.5 emission from
# all sources for each of the years 1999, 2002, 2005, and 2008.
# Subset variables required
NEI <- NEI[, c(4,6)] # Emissions and Year
# use 'reshape' to compute totals for 1999, 2002, 2005, and 2008
library(reshape2)
df <- melt(NEI, id = "year")
df <- dcast(df, year ~ variable, sum)
df
max(df$Emissions)
ceiling(max(df$Emissions))
round(max(df$Emissions))
round(max(df$Emissions), 1)
round(max(df$Emissions), 3)
# load the data files
NEI <- readRDS("summarySCC_PM25.rds")
SCC <- readRDS("Source_Classification_Code.rds")
#########
# 2. Create the plot
#########
# Have total emissions from PM2.5 decreased in the United States from 1999 to 2008?
# Using the base plotting system, make a plot showing the total PM2.5 emission from
# all sources for each of the years 1999, 2002, 2005, and 2008.
# Subset variables required
NEI <- NEI[, c(4,6)] # Emissions and Year
# use 'reshape' to compute totals for 1999, 2002, 2005, and 2008
library(reshape2)
df <- melt(NEI, id = "year")
df <- dcast(df, year ~ variable, sum)
# open the PNG device
png(file = "plot1.png", width = 720, height = 720)
# create the plot
with(df, plot(year, Emissions, type = "l", lwd = 4, col = "black", xlab = "", ylab = "", xaxt = "n",
ylim = c(0, 8000000))
axis(1, at = c(1999, 2002, 2005, 2008))
title(xlab = "Year", ylab = expression(paste("Amount of ",PM[2.5]," Emitted (in Tons)")),
main = expression(paste("Total ",PM[2.5]," Emissions in the US, 1999-2008")))
# close the PNG device
dev.off()
# open the PNG device
png(file = "plot1.png", width = 720, height = 720)
# create the plot
with(df, plot(year, Emissions, type = "l", lwd = 4, col = "black", xlab = "", ylab = "", xaxt = "n",
ylim = c(0, 8000000)))
axis(1, at = c(1999, 2002, 2005, 2008))
title(xlab = "Year", ylab = expression(paste("Amount of ",PM[2.5]," Emitted (in Tons)")),
main = expression(paste("Total ",PM[2.5]," Emissions in the US, 1999-2008")))
# close the PNG device
dev.off()
# load the data files
NEI <- readRDS("summarySCC_PM25.rds")
SCC <- readRDS("Source_Classification_Code.rds")
#########
# 2. Create the plot
#########
# Have total emissions from PM2.5 decreased in the United States from 1999 to 2008?
# Using the base plotting system, make a plot showing the total PM2.5 emission from
# all sources for each of the years 1999, 2002, 2005, and 2008.
# Subset variables required
NEI <- NEI[, c(4,6)] # Emissions and Year
# use 'reshape' to compute totals for 1999, 2002, 2005, and 2008
library(reshape2)
df <- melt(NEI, id = "year")
df <- dcast(df, year ~ variable, sum)
# open the PNG device
png(file = "plot1.png", width = 720, height = 720)
# create the plot
with(df, plot(year, Emissions, type = "l", lwd = 4, col = "black", xlab = "", ylab = "", xaxt = "n",
ylim = c(0, ceiling(df$Emissions), 6)))
axis(1, at = c(1999, 2002, 2005, 2008))
title(xlab = "Year", ylab = expression(paste("Amount of ",PM[2.5]," Emitted (in Tons)")),
main = expression(paste("Total ",PM[2.5]," Emissions in the US, 1999-2008")))
# close the PNG device
dev.off()
# create the plot
with(df, plot(year, Emissions, type = "l", lwd = 4, col = "black", xlab = "", ylab = "", xaxt = "n",
ylim = c(0, signif(df$Emissions), 6)))
axis(1, at = c(1999, 2002, 2005, 2008))
title(xlab = "Year", ylab = expression(paste("Amount of ",PM[2.5]," Emitted (in Tons)")),
main = expression(paste("Total ",PM[2.5]," Emissions in the US, 1999-2008")))
# create the plot
with(df, plot(year, Emissions, type = "l", lwd = 4, col = "black", xlab = "", ylab = "", xaxt = "n",
ylim = c(0, signif(df$Emissions, 6)))
axis(1, at = c(1999, 2002, 2005, 2008))
title(xlab = "Year", ylab = expression(paste("Amount of ",PM[2.5]," Emitted (in Tons)")),
main = expression(paste("Total ",PM[2.5]," Emissions in the US, 1999-2008")))
with(df, plot(year, Emissions, type = "l", lwd = 4, col = "black", xlab = "", ylab = "", xaxt = "n",
ylim = c(0, signif(df$Emissions, digits = 6)))
axis(1, at = c(1999, 2002, 2005, 2008))
title(xlab = "Year", ylab = expression(paste("Amount of ",PM[2.5]," Emitted (in Tons)")),
main = expression(paste("Total ",PM[2.5]," Emissions in the US, 1999-2008")))
# create the plot
with(df, plot(year, Emissions, type = "l", lwd = 4, col = "black", xlab = "", ylab = "", xaxt = "n",
ylim = c(0, signif(df$Emissions, digits = 6))))
axis(1, at = c(1999, 2002, 2005, 2008))
title(xlab = "Year", ylab = expression(paste("Amount of ",PM[2.5]," Emitted (in Tons)")),
main = expression(paste("Total ",PM[2.5]," Emissions in the US, 1999-2008")))
signif(df$Emissions, digits = 6)
with(df, plot(year, Emissions, type = "l", lwd = 4, col = "black", xlab = "", ylab = "", xaxt = "n",
ylim = c(0, signif(max(df$Emissions, digits = 6)))))
axis(1, at = c(1999, 2002, 2005, 2008))
title(xlab = "Year", ylab = expression(paste("Amount of ",PM[2.5]," Emitted (in Tons)")),
main = expression(paste("Total ",PM[2.5]," Emissions in the US, 1999-2008")))
signif(df$Emissions, digits = 6)
# load the data files
NEI <- readRDS("summarySCC_PM25.rds")
SCC <- readRDS("Source_Classification_Code.rds")
#########
# 2. Create the plot
#########
# Have total emissions from PM2.5 decreased in the United States from 1999 to 2008?
# Using the base plotting system, make a plot showing the total PM2.5 emission from
# all sources for each of the years 1999, 2002, 2005, and 2008.
# Subset variables required
NEI <- NEI[, c(4,6)] # Emissions and Year
# use 'reshape' to compute totals for 1999, 2002, 2005, and 2008
library(reshape2)
df <- melt(NEI, id = "year")
df <- dcast(df, year ~ variable, sum)
# open the PNG device
png(file = "plot1.png", width = 720, height = 720)
# create the plot
with(df, plot(year, Emissions, type = "l", lwd = 4, col = "black", xlab = "", ylab = "", xaxt = "n",
ylim = c(0, 8000000)))
axis(1, at = c(1999, 2002, 2005, 2008))
title(xlab = "Year", ylab = expression(paste("Amount of ",PM[2.5]," Emitted (in Tons)")),
main = expression(paste("Total ",PM[2.5]," Emissions in the US, 1999-2008")))
# close the PNG device
dev.off()
# load the data files
NEI <- readRDS("summarySCC_PM25.rds")
SCC <- readRDS("Source_Classification_Code.rds")
#########
# 2. Create the plot
#########
# Have total emissions from PM2.5 decreased in Baltimore City, Maryland
# (fips == "24510") from 1999 to 2008? Use the base plotting system to make
# a plot answering this question.
# Subset cases and variables required
NEI <- subset(NEI, fips == 24510) # Baltimore data
NEI <- NEI[, c(4,6)] # Emissions and Year
# use 'reshape' to compute total for Baltimore for 1999, 2002, 2005, and 2008
library(reshape2)
df <- melt(NEI, id = "year")
df <- dcast(df, year ~ variable, sum)
max(df$Emissions)
# open the PNG device
png(file = "plot2.png", width = 720, height = 720)
# create the plot
with(df, plot(year, Emissions, type = "l", lwd = 4, col = "black", xlab = "", ylab = "", xaxt = "n",
ylim = c(0, 3500)))
axis(1, at = c(1999, 2002, 2005, 2008))
title(xlab = "Year", ylab = expression(paste("Amount of ",PM[2.5]," Emitted (in Tons)")),
main = expression(paste("Total ",PM[2.5]," Emissions in Baltimore City, 1999-2008")))
# close the PNG device
dev.off()
# load the data files
NEI <- readRDS("summarySCC_PM25.rds")
SCC <- readRDS("Source_Classification_Code.rds")
#########
# 2. Create the plot
#########
# Of the four types of sources indicated by the type (point, nonpoint, onroad, nonroad)
# variable, which of these four sources have seen decreases in emissions from 1999–2008
# for Baltimore City? Which have seen increases in emissions from 1999–2008? Use the
# ggplot2 plotting system to make a plot answer this question.
# Subset cases and variables required
NEI <- subset(NEI, fips == 24510) # Baltimore data
NEI <- NEI[, 4:6] # Emissions, Type and Year
# clean up the type variable for plotting
library(Hmisc)
names(NEI)[names(NEI) == "type"] <- "Type"
NEI$Type <- capitalize(tolower(NEI$Type))
NEI$Type <- factor(NEI$Type)
# use 'reshape' to compute totals for each source for Baltimore for 1999, 2002, 2005, and 2008
library(reshape2)
df <- melt(NEI, id = c("Type", "year"))
df <- dcast(df, Type + year ~ variable, sum)
max(df$Emissions)
# open the PNG device
png(file = "plot3.png", width = 720, height = 720)
# create the plot
library(ggplot2)
g <- ggplot(df, aes(x = year, y = Emissions, group = Type, colour = Type)) + geom_line(size = 1.25)
g <- g + scale_x_continuous(breaks = c(1999, 2002, 2005, 2008)) +
scale_y_continuous(limits = c(0, 2500)) +
labs(x = "Year", y = expression(paste("Amount of ",PM[2.5]," Emitted (in Tons)"))) +
labs(title = expression(paste("Total ",PM[2.5]," Emissions in Baltimore City by Source, 1999-2008"))) +
theme(legend.position = "top")
print(g)
# close the PNG device
dev.off()
# load the data files
NEI <- readRDS("summarySCC_PM25.rds")
SCC <- readRDS("Source_Classification_Code.rds")
#########
# 2. Create the plot
#########
# Across the United States, how have emissions from coal combustion-related sources changed from 1999–2008?
# subset cases and variables required
keep <- grep("Coal", SCC$EI.Sector) # get row numbers for EI Sectors with the word "Coal"
coal <- SCC[keep, ] # extract SCC rows related to coal combustion
NEI <- subset(NEI, SCC %in% coal$SCC) # subset coal combustion NEI data based on SCC codes
NEI <- NEI[, c(4,6)] # Emissions and Year
# use 'reshape' to compute totals for 1999, 2002, 2005, and 2008
library(reshape2)
df <- melt(NEI, id = "year")
df <- dcast(df, year ~ variable, sum)
max(df$Emissions)
# open the PNG device
png(file = "plot4.png", width = 720, height = 720)
# create the plot
library(ggplot2)
g <- ggplot(df, aes(x = year, y = Emissions)) + geom_line(size = 1.25)
g <- g + scale_x_continuous(breaks = c(1999, 2002, 2005, 2008)) +
scale_y_continuous(limits = c(0, 6000000)) +
labs(x = "Year", y = expression(paste("Amount of ",PM[2.5]," Emitted (in Tons)"))) +
labs(title = expression(paste("Coal Combustion ",PM[2.5]," Emissions in the US, 1999-2008")))
print(g)
# close the PNG device
dev.off()
# open the PNG device
png(file = "plot4.png", width = 720, height = 720)
# create the plot
library(ggplot2)
g <- ggplot(df, aes(x = year, y = Emissions)) + geom_line(size = 1.25)
g <- g + scale_x_continuous(breaks = c(1999, 2002, 2005, 2008)) +
scale_y_continuous(limits = c(0, 600000)) +
labs(x = "Year", y = expression(paste("Amount of ",PM[2.5]," Emitted (in Tons)"))) +
labs(title = expression(paste("Coal Combustion ",PM[2.5]," Emissions in the US, 1999-2008")))
print(g)
# close the PNG device
dev.off()
# load the data files
NEI <- readRDS("summarySCC_PM25.rds")
SCC <- readRDS("Source_Classification_Code.rds")
#########
# 2. Create the plot
#########
# How have emissions from motor vehicle sources changed from 1999–2008 in Baltimore City?
# subset cases and variables required
NEI <- subset(NEI, fips == 24510 & type == "ON-ROAD") # on-road NEI data for Baltimore
NEI <- NEI[, c(4,6)] # Emissions and Year
# use 'reshape' to compute totals for 1999, 2002, 2005, and 2008
library(reshape2)
df <- melt(NEI, id = "year")
df <- dcast(df, year ~ variable, sum)
max(df$Emissions)
# create the plot
library(ggplot2)
g <- ggplot(df, aes(x = year, y = Emissions)) + geom_line(size = 1.25)
g <- g + scale_x_continuous(breaks = c(1999, 2002, 2005, 2008)) +
scale_y_continuous(limits = c(0, max(df$Emissions))) +
labs(x = "Year", y = expression(paste("Amount of ",PM[2.5]," Emitted (in Tons)"))) +
labs(title = expression(paste("Motor Vehicle ",PM[2.5]," Emissions in Baltimore City, 1999-2008")))
print(g)
# open the PNG device
png(file = "plot5.png", width = 720, height = 720)
# create the plot
library(ggplot2)
g <- ggplot(df, aes(x = year, y = Emissions)) + geom_line(size = 1.25)
g <- g + scale_x_continuous(breaks = c(1999, 2002, 2005, 2008)) +
scale_y_continuous(limits = c(0, 400)) +
labs(x = "Year", y = expression(paste("Amount of ",PM[2.5]," Emitted (in Tons)"))) +
labs(title = expression(paste("Motor Vehicle ",PM[2.5]," Emissions in Baltimore City, 1999-2008")))
print(g)
# close the PNG device
dev.off()
# load the data files
NEI <- readRDS("summarySCC_PM25.rds")
SCC <- readRDS("Source_Classification_Code.rds")
#########
# 2. Create the plot
#########
# Compare emissions from motor vehicle sources in Baltimore City with emissions
# from motor vehicle sources in Los Angeles County, California (fips == "06037").
# Which city has seen greater changes over time in motor vehicle emissions?
# subset cases and variables required
NEI <- subset(NEI, fips %in% c("24510", "06037") & type == "ON-ROAD") # on-road NEI data for Baltimore & LA
NEI <- NEI[, c(1,4,6)] # County, Emissions and Year
# clean up the fips variable for plotting
names(NEI)[names(NEI) == "fips"] <- "County"
NEI$County[NEI$County == "24510"] <- "Baltimore City"
NEI$County[NEI$County == "06037"] <- "Los Angeles County"
# use 'reshape' to compute totals for Baltimore and Los Angeles for 1999, 2002, 2005, and 2008
library(reshape2)
df <- melt(NEI, id = c("County", "year"))
df <- dcast(df, County + year ~ variable, sum)
max(df$Emissions)
library(ggplot2)
g <- ggplot(df, aes(x = year, y = Emissions, group = County, colour = County)) + geom_line(size = 1.25)
g <- g + scale_x_continuous(breaks = c(1999, 2002, 2005, 2008)) +
scale_y_continuous(limits = c(0, 5000)) +
labs(x = "Year", y = expression(paste("Amount of ",PM[2.5]," Emitted (in Tons)"))) +
labs(title = expression(paste("Motor Vehicle ",PM[2.5]," Emissions by County, 1999-2008"))) +
theme(legend.position = "top")
print(g)
# open the PNG device
png(file = "plot6.png", width = 720, height = 720)
# create the plot
library(ggplot2)
g <- ggplot(df, aes(x = year, y = Emissions, group = County, colour = County)) + geom_line(size = 1.25)
g <- g + scale_x_continuous(breaks = c(1999, 2002, 2005, 2008)) +
scale_y_continuous(limits = c(0, 5000)) +
labs(x = "Year", y = expression(paste("Amount of ",PM[2.5]," Emitted (in Tons)"))) +
labs(title = expression(paste("Motor Vehicle ",PM[2.5]," Emissions by County, 1999-2008"))) +
theme(legend.position = "top")
print(g)
# close the PNG device
dev.off()
# load the data files
NEI <- readRDS("summarySCC_PM25.rds")
SCC <- readRDS("Source_Classification_Code.rds")
#########
# 2. Create the plot
#########
# Have total emissions from PM2.5 decreased in the United States from 1999 to 2008?
# Using the base plotting system, make a plot showing the total PM2.5 emission from
# all sources for each of the years 1999, 2002, 2005, and 2008.
# Subset variables required
NEI <- NEI[, c(4,6)] # Emissions and Year
# use 'reshape' to compute totals for 1999, 2002, 2005, and 2008
library(reshape2)
df <- melt(NEI, id = "year")
df <- dcast(df, year ~ variable, sum)
# inspect the data file
df
# open the PNG device
png(file = "plot1.png", width = 480, height = 480)
# create the plot
with(df, plot(year, Emissions, type = "l", lwd = 4, col = "black", xlab = "", ylab = "", xaxt = "n",
ylim = c(0, 8000000)))
axis(1, at = c(1999, 2002, 2005, 2008))
title(xlab = "Year", ylab = expression(paste("Amount of ",PM[2.5]," Emitted (in Tons)")),
main = expression(paste("Total ",PM[2.5]," Emissions in the US, 1999-2008")))
# close the PNG device
dev.off()
# load the data files
NEI <- readRDS("summarySCC_PM25.rds")
SCC <- readRDS("Source_Classification_Code.rds")
#########
# 2. Create the plot
#########
# Have total emissions from PM2.5 decreased in Baltimore City, Maryland
# (fips == "24510") from 1999 to 2008? Use the base plotting system to make
# a plot answering this question.
# Subset cases and variables required
NEI <- subset(NEI, fips == 24510) # Baltimore data
NEI <- NEI[, c(4,6)] # Emissions and Year
# use 'reshape' to compute total for Baltimore for 1999, 2002, 2005, and 2008
library(reshape2)
df <- melt(NEI, id = "year")
df <- dcast(df, year ~ variable, sum)
# inspect the data file
df
# open the PNG device
png(file = "plot2.png", width = 480, height = 480)
# create the plot
with(df, plot(year, Emissions, type = "l", lwd = 4, col = "black", xlab = "", ylab = "", xaxt = "n",
ylim = c(0, 3500)))
axis(1, at = c(1999, 2002, 2005, 2008))
title(xlab = "Year", ylab = expression(paste("Amount of ",PM[2.5]," Emitted (in Tons)")),
main = expression(paste("Total ",PM[2.5]," Emissions in Baltimore City, 1999-2008")))
# close the PNG device
dev.off()
# load the data files
NEI <- readRDS("summarySCC_PM25.rds")
SCC <- readRDS("Source_Classification_Code.rds")
#########
# 2. Create the plot
#########
# Of the four types of sources indicated by the type (point, nonpoint, onroad, nonroad)
# variable, which of these four sources have seen decreases in emissions from 1999–2008
# for Baltimore City? Which have seen increases in emissions from 1999–2008? Use the
# ggplot2 plotting system to make a plot answer this question.
# Subset cases and variables required
NEI <- subset(NEI, fips == 24510) # Baltimore data
NEI <- NEI[, 4:6] # Emissions, Type and Year
# clean up the type variable for plotting
library(Hmisc)
names(NEI)[names(NEI) == "type"] <- "Type"
NEI$Type <- capitalize(tolower(NEI$Type))
NEI$Type <- factor(NEI$Type)
# use 'reshape' to compute totals for each source for Baltimore for 1999, 2002, 2005, and 2008
library(reshape2)
df <- melt(NEI, id = c("Type", "year"))
df <- dcast(df, Type + year ~ variable, sum)
# inspect the data file
df
# open the PNG device
png(file = "plot3.png", width = 480, height = 480)
# create the plot
library(ggplot2)
g <- ggplot(df, aes(x = year, y = Emissions, group = Type, colour = Type)) + geom_line(size = 1.25)
g <- g + scale_x_continuous(breaks = c(1999, 2002, 2005, 2008)) +
scale_y_continuous(limits = c(0, 2500)) +
labs(x = "Year", y = expression(paste("Amount of ",PM[2.5]," Emitted (in Tons)"))) +
labs(title = expression(paste("Total ",PM[2.5]," Emissions in Baltimore City by Source, 1999-2008"))) +
theme(legend.position = "top")
print(g)
# close the PNG device
dev.off()
# open the PNG device
png(file = "plot3.png", width = 480, height = 480)
# create the plot
library(ggplot2)
g <- ggplot(df, aes(x = year, y = Emissions, group = Type, colour = Type)) + geom_line(size = 1.25)
g <- g + scale_x_continuous(breaks = c(1999, 2002, 2005, 2008)) +
scale_y_continuous(limits = c(0, 2500)) +
labs(x = "Year", y = expression(paste("Amount of ",PM[2.5]," Emitted (in Tons)"))) +
labs(title = expression(paste("Total ",PM[2.5]," Emissions in Baltimore City by Type, 1999-2008"))) +
theme(legend.position = "top")
print(g)
# close the PNG device
dev.off()
# load the data files
NEI <- readRDS("summarySCC_PM25.rds")
SCC <- readRDS("Source_Classification_Code.rds")
#########
# 2. Create the plot
#########
# Across the United States, how have emissions from coal combustion-related sources changed from 1999–2008?
# subset cases and variables required
keep <- grep("Coal", SCC$EI.Sector) # get row numbers for EI Sectors with the word "Coal"
coal <- SCC[keep, ] # extract SCC rows related to coal combustion
NEI <- subset(NEI, SCC %in% coal$SCC) # subset coal combustion NEI data based on SCC codes
NEI <- NEI[, c(4,6)] # Emissions and Year
# use 'reshape' to compute totals for 1999, 2002, 2005, and 2008
library(reshape2)
df <- melt(NEI, id = "year")
df <- dcast(df, year ~ variable, sum)
# inspect the data file
df
# open the PNG device
png(file = "plot4.png", width = 480, height = 480)
# create the plot
library(ggplot2)
g <- ggplot(df, aes(x = year, y = Emissions)) + geom_line(size = 1.25)
g <- g + scale_x_continuous(breaks = c(1999, 2002, 2005, 2008)) +
scale_y_continuous(limits = c(0, 600000)) +
labs(x = "Year", y = expression(paste("Amount of ",PM[2.5]," Emitted (in Tons)"))) +
labs(title = expression(paste("Coal Combustion ",PM[2.5]," Emissions in the US, 1999-2008")))
print(g)
# close the PNG device
dev.off()
# load the data files
NEI <- readRDS("summarySCC_PM25.rds")
SCC <- readRDS("Source_Classification_Code.rds")
#########
# 2. Create the plot
#########
# How have emissions from motor vehicle sources changed from 1999–2008 in Baltimore City?
# subset cases and variables required
NEI <- subset(NEI, fips == 24510 & type == "ON-ROAD") # on-road NEI data for Baltimore
NEI <- NEI[, c(4,6)] # Emissions and Year
# use 'reshape' to compute totals for 1999, 2002, 2005, and 2008
library(reshape2)
df <- melt(NEI, id = "year")
df <- dcast(df, year ~ variable, sum)
# inspect the data file
df
# open the PNG device
png(file = "plot5.png", width = 480, height = 480)
# create the plot
library(ggplot2)
g <- ggplot(df, aes(x = year, y = Emissions)) + geom_line(size = 1.25)
g <- g + scale_x_continuous(breaks = c(1999, 2002, 2005, 2008)) +
scale_y_continuous(limits = c(0, 400)) +
labs(x = "Year", y = expression(paste("Amount of ",PM[2.5]," Emitted (in Tons)"))) +
labs(title = expression(paste("Motor Vehicle ",PM[2.5]," Emissions in Baltimore City, 1999-2008")))
print(g)
# close the PNG device
dev.off()
# load the data files
NEI <- readRDS("summarySCC_PM25.rds")
SCC <- readRDS("Source_Classification_Code.rds")
#########
# 2. Create the plot
#########
# Compare emissions from motor vehicle sources in Baltimore City with emissions
# from motor vehicle sources in Los Angeles County, California (fips == "06037").
# Which city has seen greater changes over time in motor vehicle emissions?
# subset cases and variables required
NEI <- subset(NEI, fips %in% c("24510", "06037") & type == "ON-ROAD") # on-road NEI data for Baltimore & LA
NEI <- NEI[, c(1,4,6)] # County, Emissions and Year
# clean up the fips variable for plotting
names(NEI)[names(NEI) == "fips"] <- "County"
NEI$County[NEI$County == "24510"] <- "Baltimore City"
NEI$County[NEI$County == "06037"] <- "Los Angeles County"
# use 'reshape' to compute totals for Baltimore and Los Angeles for 1999, 2002, 2005, and 2008
library(reshape2)
df <- melt(NEI, id = c("County", "year"))
df <- dcast(df, County + year ~ variable, sum)
# inspect the data file
df
# open the PNG device
png(file = "plot6.png", width = 480, height = 480)
# create the plot
library(ggplot2)
g <- ggplot(df, aes(x = year, y = Emissions, group = County, colour = County)) + geom_line(size = 1.25)
g <- g + scale_x_continuous(breaks = c(1999, 2002, 2005, 2008)) +
scale_y_continuous(limits = c(0, 5000)) +
labs(x = "Year", y = expression(paste("Amount of ",PM[2.5]," Emitted (in Tons)"))) +
labs(title = expression(paste("Motor Vehicle ",PM[2.5]," Emissions by County, 1999-2008"))) +
theme(legend.position = "top")
print(g)
# close the PNG device
dev.off()
